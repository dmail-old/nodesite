module.exports = {
	requires: 'requestNegotiation',

	request: {
		parsers: require('./parsers'),
		body: null
	},

	handle: function(request, response, handler){
		var stream, mediaType = request.mediaType;

		if( mediaType in request.parsers ){
			request.parsers[mediaType](request.stream, function(error, body){
				if( error ){
					handler.next(error);
				}
				else{
					request.body = body;
					handler.next();
				}
			});
		}
		else{
			handler.next();
		}
	}
};