module.exports = {
	request: {
		parsers: require('./parsers'),
		bodyParams: null
	},

	handle: function(request, response, handler){
		var stream = request.stream, mediaType;

		if( stream ){
			mediaType = request.mediaType;

			if( mediaType in request.parsers ){
				request.parsers[mediaType](stream, function(error, params){
					if( error ){
						handler.next(error);
					}
					else{
						request.bodyParams = params;
						handler.next();
					}
				});
			}
		}
	}
};