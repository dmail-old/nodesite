module.exports = {
	request: {
		user: null,
	},

	handle: function(request, response, handler){
		var session = request.cookieParams['session'];

		if( !session ) return handler.next();

		request.user = this.database.find('user', 'session:' + session, function(error, user){
			if( error ){
				handler.next(error);
			}
			else{
				request.user = user;
				handler.next();
			}
		}, request);
	}
};