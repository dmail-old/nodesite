var proto = require('@dmail/proto');
var stream = require('stream');
var PassThough = stream.PassThough;

var BroadCast = proto.extend({
	listeners: null,

	constructor: function(){

	},

	ondata: function(chunk, encoding){
		this.listeners.forEach(function(listener){
			listener.ondata(chunk, encoding);
		});
	},

	onend: function(){
		this.listeners.forEach(function(listener){
			listener.onend();
		});
	},

	listen: function(listener){
		if( this.listeners === null ){
			this.listeners = [];
		}
	},

	open: function(){
		this.stream.on('data', this.ondata.bind(this));
		this.stream.on('end', this.onend.bind(this));
	}
});

module.exports = BroadCast;