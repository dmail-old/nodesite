var proto = require('proto');
var CursorIterator = require('./CursorIterator');

var Cursor = proto.create({
	headers: null,
	records: null,
	length: null,

	constructor: function(source){
		this.headers = source.shift();
		this.records = source;
		this.length = source.length;
	},

	toEntry: function(record){
		var headers = this.headers, i = 0, j = headers.length, name, entry = {};

		for(;i<j;i++){
			name = headers[i];
			entry[name] = record[i];
		}

		return entry;
	},

	values: function(){
		return new CursorIterator(this, 'value');
	},

	entries: function(){
		return new CursorIterator(this, 'entry');
	},

	'@@iterator': function(){
		return this.entries();
	}
});

module.exports = Cursor;