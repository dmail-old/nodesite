require('promise/fromStream');

module.exports = {
	name: 'request-body',

	properties: {
		parsers: require('./parsers'),
	},

	task: function(){
		var request = this, mediaType = this.mediaType;

		if( mediaType && mediaType in request.parsers ){
			return request.consume().then(String).then(function(body){
				request.rawBody = body;
				request.bodyParams = request.parsers[mediaType](body);
			});
		}
	}
};