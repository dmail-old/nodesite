module.exports = {
	request: {
		user: null,
		cookieSession: 'session'
	},

	handle: function(router){
		var request = router.request;
		var session = request.cookieParams[this.request.cookieSession];

		if( !session ) return router.next();

		request.user = DB.find('user', 'session:' + session, function(error, user){
			if( error ){
				router.next(error);
			}
			else{
				request.user = user;
				router.next();
			}
		}, request);
	}
};