module.exports = {
	name: 'requestBody',
	requires: 'requestNegotiation',

	extend: {
		parsers: require('./parsers')
	},

	handle: function(handler){
		var request = handler.request;
		var stream, mediaType = request.mediaType;

		if( mediaType in handler.parsers ){
			return request.createBodyPromise().then(function(buffer){
				var body = buffer.toString();

				handler.request.body = body;
				handler.request.bodyParams = handler.parsers[mediaType](body);
			});
		}
	}
};