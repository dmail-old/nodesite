var RequestHeader = require('./requestHeader');
var ContentEncodingHeader = RequestHeader.extend({
	name: 'content-encoding',
	decoders: require('./decoders'),

	errorStatusCode: 415,
	errorMessage: 'Unsupported {headerName}:{headerValue} request header. Supported values: {supporteds}',

	getValue: function(bodyReader){
		return bodyReader.request.encoding;
	},

	getSupporteds: function(){
		return Object.keys(this.decoders);
	},
	
	createError: function(){
		return RequestHeader.createError.call(this, this.errorStatusCode, this.errorMessage, {
			supporteds: this.getSupporteds()
		});
	},	

	isValid: function(){
		return this.value in this.decoders;
	},

	effect: function(){
		this.decoders[this.value].call(this);
	}
});

module.exports = ContentEncodingHeader;