var ObjectPath = require('objectPath/objectPath');
var PartObserver = require('./partObserver');
var PathObserver = ObjectPath.extend({
	partConstructor: PartObserver,
	closed: false,

	create: function(path, model, listener, bind, alias){
		ObjectPath.create.call(this, path);

		if( arguments.length > 1 ){
			this.setModel(model);
			if( arguments.length > 2 ){
				this.lastPart.listenChange(listener, bind || this);
				this.lastPart.alias = alias;
			}
		}
	},

	close: function(){
		// closing firstPart auto close nextParts
		this.firstPart.close.apply(this.firstPart, arguments);
		return this;
	}
});

module.exports = PathObserver;