/* 

https://api.dartlang.org/apidocs/channels/stable/#observe/observe.PathObserver

property accessor: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Member_Operators

*/
var PropertyAccessor = require('PropertyAccessor');
var PropertyAccessorObserver = PropertyAccessor.extend({
	partPrototype: require('./partObserver'),
	closed: false,

	init: function(path, model, listener, bind, alias){
		PropertyAccessor.init.call(this, path);

		if( arguments.length > 1 ){
			this.setModel(model);
			if( arguments.length > 2 ){
				this.setListener(listener, bind || this, alias);
			}
		}
	},

	setListener: function(){
		this.lastPart.setListener.apply(this.lastPart, arguments);
		return this;
	},

	close: function(){
		// closing firstPart auto close nextParts
		this.firstPart.close.apply(this.firstPart, arguments);
		return this;
	},

	get lastChange(){
		return this.lastPart.lastChange;
	}
});

module.exports = PropertyAccessorObserver;