/* 

https://api.dartlang.org/apidocs/channels/stable/#observe/observe.PathObserver

property accessor: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Member_Operators

*/
var PropertyPath = require('PropertyPath');
var PropertyPathObserver = PropertyPath.create({
	partPrototype: require('./PartObserver'),
	closed: false,

	init: function(path, model, listener, bind, id, suppressNotify){
		PropertyPath.init.call(this, path);

		if( arguments.length > 1 ){
			this.setModel(model);
			if( arguments.length > 2 ){
				this.open(listener, bind || this, id, suppressNotify);
			}
		}
	},

	open: function(){
		this.lastPart.open.apply(this.lastPart, arguments);
		return this;
	},

	close: function(){
		// closing firstPart auto close nextParts
		this.firstPart.close.apply(this.firstPart, arguments);
		return this;
	},

	get lastChange(){
		return this.lastPart.lastChange;
	}
});

module.exports = PropertyPathObserver;