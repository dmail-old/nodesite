var Selector = require('Selector');
var NodeTraversal = require('../NodeTraversal');

var NodeFinder = {
	match: function(){
		var i = 0, j = arguments.length;

		for(;i<j;i++){
			if( Selector.new(arguments[i]).match(this) ) return true;
		}

		return false;
	}
};

require('property').forEachKey(NodeTraversal, function(name, iterator){
	if( typeof iterator != 'function' ) return;

	NodeFinder['get' + name.capitalizeFirst()] = function(selector, all){
		if( typeof selector == 'undefined' ){
			selector = true;
		}

		var found = all ? [] : null;

		iterator.call(this, function(node){
			if( selector.match(node) ){
				if( all ){
					found.push(node); 
				}
				else{
					found = node;
					return true;
				}
			}
		});

		return found;
	};
});

module.exports = NodeFinder;