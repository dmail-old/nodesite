<!DOCTYPE html>

<html dir="ltr">

	<head>
		{%metas%}
		<title>{%title%}</title>
		<link href="{%origin%}/{%favicon%}" type="image/x-icon" rel="shortcut icon"/>
		{%styles%}
		<script type="text/javascript">
			window.config = {%config%};
			window.lang = {%lang%};
			window.onerror = function(msg, url, line){
				//console.log('window error', arguments);
			};
		</script>
		<script src="{%origin%}/js/module.js" type="text/javascript"></script>
	</head>

	<body>

		<noscript>Javascript is disabled this app will not work</noscript>

		<script>

			window.$ = document.getElementById.bind(document);
			document.html = document.documentElement;

			(function(){
				var modules = {%modules%}, module;

				for(var path in modules){
					module = new Module(path, window.module);
					module.source = modules[path];
					module.compile();
				}
			})();

			// app.init will be called once css and js have fully loaded
			window.onload = function(){
				// setTimeout is to avoid initial popstate event
				setTimeout(function(){ require('app').app.init(); }, 0);
			};

		</script>

		<div id="page"></div>

		{%scripts%}

	</body>

</html>
