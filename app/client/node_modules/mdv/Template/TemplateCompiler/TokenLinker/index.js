require('../Node.bind');
/*

name: TokenLinker
description: link a node attribute to a model value adding a prefix and a suffix
example: <span>Hello {name}!</span>

*/
var DirectLinker = require('../DirectLinker');
var Observer = require('Observer').PropertyAccessorObserver;
var proto = require('proto');

var TokenLinker = proto.extend(DirectLinker, {
	name: 'TokenLinker',
	prefix: '',
	suffix: '',

	constructor: function(nodeAttribute, modelPath, prefix, suffix){
		DirectLinker.call(this, nodeAttribute, modelPath);
		this.prefix = prefix;
		this.suffix = suffix;
	},

	link: function(node, model){
		var self = this;
		var specificModel = {};
		Observer.new(this.modelPath, model, function(change){
			specificModel.value = self.prefix + change.value + self.suffix;
		});

		// node is binded to specificModel.value wich is updated when pathobserver changes
		node.bind(this.nodeAttribute, specificModel, 'value');
	},

	unlink: function(node){
		node.unbind(this.nodeAttribute);
	}
});

module.exports = TokenLinker;
