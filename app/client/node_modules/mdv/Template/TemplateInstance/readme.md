TemplateInstance
==============

Template are meant to be instantiated, this object will represent an instance of a Template.

## Example

```html
<template id="test">
    Hello {name}, your color is <span style="color:{color}">{color}</span>
</template>

<script>
var Template = require('Template');
var template = Template.new($('test'));
var instance = template.createInstance();

instance.setModel({
  name: 'damien',
  color: 'red'
});
instance.insert(document.body);
```

## Requirements

TODO

## Properties

name | description | default value
---- | ------------ | --------------
template | The template used to create this instance | null
fragment | documentFragment cloned from the template, empty once instance is in the DOM | null
firstNode | firstNode of the templateInstance fragment | null
lastNode | lastNode of the templateInstance fragment | null
model | Model used by templateInstance, any value is valid | null
hasModel | Reliable way to know if a model is set | null
nodeMap | Contains DOM nodes created by every templateInstance ~~currently in the DOM~~ (allow to find instance from node)  | new WeakMap()

## init(template)

Set the following properties : template, fragment, firstNode and lastNode

## toggleFragmentMap(fragment, link)

Add nodes of fragment from TemplateInstance.nodeMap if link = true else remove them.

## registerFragment(fragment)

Equivalent to toggleFragmentMap(fragment, true)

## unregisterFragment(fragment)

Equivalent to toggleFragmentMap(fragment, false)

## getNodeAtPath(path)

Return the node at path else null. (see [getNodeAtPat(path)](#nodepropertiesgetnodeatpathpath)).

## findNode(path)

Same as getNodeAtPath(path) but log a warning if node is not found.

## link(model)

Activate template functionnalities in fragment nodes using model.

## unlink(model)

Deactivate template functionnalities in fragment nodes.

## setModel(model)

Set the model of this instance. It will unset any previous model, set hasModel to true and call link(model).

## unsetModel()

If hasModel is true, call unlink(model), set hasModel to false and model to null.

## inDOM()

Returns true or false depending if fragment is in the DOM.

## insert(parent, before)

Insert instance nodes in the DOM after the last child of parent. If before is provided nodes will be inserted before this element.

## remove()

Remove the fragment nodes from the DOM.

## destroy()

Will ensure to clean everything once you don't need this instance anymore

## toString()

Returns 'TemplateInstance'.

## NodeProperties

NodeProperties are used to be able to find the templateInstance from a DOM Node.  
They are added to window.Node.prototype.

## NodeProperties.templateInstance

This custom getter will return templateInstance for this node else undefined.

## NodeProperties.getNodeAt(...)

Convert every arguments into a number and go down in the DOM hierarchy to find the corresponding node, else null.

```html
<div id="div">
    <p>
        Hello <strong>World</strong>
    </p>
</div>

<script>
var div = $('div');

div.getNodeAt(0); // p
div.getNodeAt(0, 0); // textNode Hello
div.getNodeAt(0, 1); // strong
</script>
```

## NodeProperties.getNodeAtPath(path)

Equivalent to getNodeAt.apply(node, path.split('.'))
