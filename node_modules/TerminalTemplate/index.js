var proto = require('proto');
var StringTemplate = require('StringTemplate');

var TerminalTemplate = proto.extend({
	template: null,
	stream: null,

	constructor: function(template, stream){
		this.template = StringTemplate.create(template);
		this.stream = stream || process.stdout;
	},

	update: function(scope){
		this.template.exec(scope);
		this.write();
	},

	write: function(){
		if( this.written ){
			this.stream.clearLine();
			//this.stream.moveCursor(0, 0);
			this.stream.cursorTo(0);
		}

		this.stream.write(this.template.toString());
		this.written = true;
	}
});

module.exports = TerminalTemplate;