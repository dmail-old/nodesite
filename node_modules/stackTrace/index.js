// https://github.com/visionmedia/callsite/blob/master/lib/__stack.js

var StackTrace = {
	fileSystem: require('fs'),

	get: function(){
		var orig = Error.prepareStackTrace;
		Error.prepareStackTrace = function(_, stack){ return stack; };
		var err = new Error();
		Error.captureStackTrace(err, arguments.callee);
		var stack = err.stack;
		Error.prepareStackTrace = orig;
		return stack;
	},

	readFileLine: function(path, line){
		var content = this.fileSystem.readFileSync(path, 'utf8');
		return content.split('\n')[line];
	}
};

module.exports = StackTrace;