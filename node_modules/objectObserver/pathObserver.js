var ObjectPath = require('objectPath/objectPath');
var PartObserver = require('./partObserver');
var PathObserver = ObjectPath.extend({
	partConstructor: PartObserver,
	closed: false,

	create: function(path, model, listener, bind, id){
		ObjectPath.create.call(this, path);

		this.setModel(model);
		this.lastPart.onChange(listener, bind || this);
		this.lastPart.id = id;
	},

	close: function(){
		// all part must be closed
		if( this.closed === false ){
			// closing firstPart auto close nextParts
			this.firstPart.close();
			this.closed = true;
		}
	}
});

module.exports = PathObserver;