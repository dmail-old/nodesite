var TestSerie = require('../TestSerie');

var FileTest = TestSerie.create({
	type: 'file',
	path: null,
	module: null,

	init: function(path){	
		this.path = path;
		this.exports = this.load(this.path);
		TestSerie.init.call(this, this.createTestList());
	},

	createTestList: function(){
		var exports = this.exports, tests = [], name;

		for(name in exports){
			tests.push(this.createTest(name, exports[name]));
		}

		return tests;
	},

	augmentError: function(e){
		e.fileTest = this;
		TestSerie.augmentError.call(this, e);
	},

	load: function(path){
		return require(path);
	},

	unload: function(path){
		delete require.cache[path];
	},

	reload: function(){
		this.unload(this.path);
		this.exports = this.load(this.path);
		this.tests = this.createTestList();
	}
});

module.exports = FileTest;