var Task = require('./task');

// Returns a task completed with this task after some ms
Task.prototype.delay = function(ms){
	var task = this.then();

	var timer = setTimeout(function(){
		task.adoptState = Task.prototype.adoptState;
		task.adoptState(this);
	}.bind(this), ms);

	task.adoptState = function(){

	};

	// clean timer
	task.clean = function(){
		clearTimeout(timer);
		return this.constructor.prototype.clean.call(this);
	};

	return task;
};

require('task/complete');

function delay(ms, value){
	return Task.complete(value).delay(ms);
}

module.exports = delay;
Task.delay = delay;