var Task = require('./task');

function exec(fn, bind, value){
	var ret, error;

	if( typeof fn != 'function' ){
		throw new TypeError('function expected ' + fn + ' given');
	}

	try{
		ret = fn.call(bind, value);
	}
	catch(e){
		error = e;
	}

	var task = new Task(fn.name);

	if( error ){
		task.fail(error);
	}
	else{
		task.complete(ret);
	}

	return task;
}

module.exports = exec;
Task.exec = exec;