# task

A task looks like a promise with pause/resume/cancel/progress mecanism + a lot of utilities.  
It's one of the most wonderful thing in the world, yes, it is.

Inspired by https://github.com/petkaantonov/bluebird/blob/master/API.md#all---promise

## Example

```javascript
// todo
```

## properties

Name  | Description | Default
----- | --- | ---------
state | Can be 'pending', 'completed', 'failed' | 'pending'
isPaused  | Boolean indicating if the task is paused | false
isCancelled | Boolean indicating if the task is cancelled | false
value | Value of this task | null

## cancel()

The task will never complete or fail & any current task is cancelled as well.

## pause()

The task completion/failure is ignored until task.resume() is called.

## resume()

Reconsider task completion/failure, it the task completed/failed while paused, the task complete/fails immediatly

## complete(value)

If value is a Task it becomes the current task, they are interdependant which means cancel/pause/resume/complete/fail of this task or value affect the other.
If value is a thenable it's resolved before completing this task.
Once the value is resolved this task value is set & state is set to 'completed'.

## fail(value)

Set task value to value & state to 'failed'.

## then(onCompletion, onFailure, bind)

Create a task who will complete/fails when this task complete/fails.
onCompletion(value) & onFailure(value) are optional function used to change the value.

## The difference between nested task & then()

Nested tasks are are linked, cancelling/pausing one affect others.
Then create separate tasks, cancelling/pausing doesn't affect others.

```javascript
// let's say you want to update a JSON file like {"id": 0}
function createReadFilePromise(path){}
function createWriteFilePromise(path, content){}
var path = 'file.json', updateTask;

updateTaskWrongStyle = Task.complete(path).then(createReadFilePromise).then(JSON.parse).
then(function(content){
  content.id++;
  return content;
}).then(JSON.stringify).then(createWriteFilePromise);

updateTaskRightStyle = Task.pipe([
  createReadFilePromise,
  JSON.parse,
  function(content){
    content.id++;
    return content;
  },
  JSON.stringify,
  createWriteFilePromise
], null, path);

updateTaskWrongStyle.cancel(); // cancels the last task
updateTaskRightStyle.cancel(); // cancels the current task running
```

## Undocumented

- delay(ms)
- timeout(ms)
- spread(onCompletion, onFailure, bind)
- finally(onCompletionOrFailure, bind)

## Static function (helpers)

- Task.complete(value)
- Task.fail(value)
- Task.delay(ms, value)
- Task.all(iterable)
- Task.any(iterable)
- Task.race(iterable)
- Task.map(iterable, fn, bind)
- Task.pipe(iterable, bind, initialValue)
- Task.reduce(iterable, fn, bind, initialValue)
