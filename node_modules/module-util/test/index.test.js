function requireModuleWithoutCache(path){
	var fileName = require.resolve(path);
	delete require.cache[fileName];
	require(fileName);
	return require.cache[fileName];
}

exports['module children property is affected by module cache'] = function(test){
	['./module-a', './module-b', './module-c'].forEach(function(fileName){
		delete require.cache[require.resolve(fileName)];
	});

	var moduleA = requireModuleWithoutCache('./module-a');
	var moduleB = requireModuleWithoutCache('./module-b');

	// moduleA says he got 1 children but he requires b and c
	// but b declare c as a dependency so a don't know c is part of his dependencies
	test.equal(moduleA.children.length, 1);

	moduleA = requireModuleWithoutCache('./module-a');
	test.equal(moduleA.children.length, 0);
};

/*

moduleA ne déclare aucune dépendance
moduleB déclare qu'il dépend de C

*/