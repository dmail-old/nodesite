<!--

Ce fichier est renvoyé à toute requête GET sauf:

- si l'URL débute par un dossier existant: '/css/*, /js/*, /img/*'
- si l'URL cible la racine et un fichier d'extension différente de .js: '/manifest.appcache'

Il consititue le cadre du site, on récup des infos depuis le serveur dans les {}
Une fois tout ceci fait on appele app.init pour afficher la page correspondante

-->

<!DOCTYPE html>

<html dir="ltr">

	<head>
		{metas}
		<title>{title}</title>
		{favicon}
		{styles}
		<script type="text/javascript">

			window.NS = {};
			window.config = {config};
			window.lang = JSON.stringify({lang});
			// Function.reviver existe pas encore ici
			lang = JSON.parse(lang, function(key, value){
				return typeof value == 'string' && value.indexOf('(function (') === 0 ? eval(value) : value;
			});

			window.root = document.location.protocol + '//' + document.location.host;

			window.onerror = function(msg, url, line){
				//console.log('window error', arguments);
			};

			if( !window.setImmediate ){

				window.setImmediate = function(fn, args){
					return window.setTimeout(fn, 0, args);
				};
				window.clearImmediate = window.clearTimeout;

			}

		</script>
	</head>

	<body>
		<script>

			// app.init will be called once css and js have fully loaded
			window.onload = function(){
				// setTimeout is to avoid initial popstate event
				setTimeout(function(){ window.app.init.call(window.app); }, 0);
			};

		</script>

		{scripts}

		<div id="page"></div>
	</body>

</html>
