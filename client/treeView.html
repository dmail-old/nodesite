<script>
var treeData = {
	name: 'rootnode',
	children: [
		{name: 'node0', children: [{name: 'node0.1'}]},
		{name: 'node1'},
		{name: 'node2', children: [{name: 'node2.1'}, {name: 'node2.2'}]},
		{name: 'node3', children: [{name: 'node3.1'}]}
	]
};

// plus tard on aura surement des méthodes raccourcies pour créer un MVC complet tel que treeView

var root = new NodeModel(treeData);
var treeView = new TreeView(root);

Controller.add(treeView, 'indent');
Controller.add(treeView, 'tool');
Controller.add(treeView, 'lighted');
Controller.add(treeView, 'focused');
Controller.add(treeView, 'visibles');
Controller.add(treeView, 'multiselection'); // 'selection');
Controller.add(treeView, 'nav');

treeView.insertElement(document.body);
//treeView.root.select();

treeView.root.expand();
treeView.root.children[0].expand();
treeView.root.children[2].expand();
treeView.root.children[3].expand();

/*
Object.append = function(object, source){
	Object.keys(source).forEach(function(key){
        Object.defineProperty(object, key, Object.getOwnPropertyDescriptor(source, key));
    });
    return object;
};

Object.merge = function(object, source){
	Object.getOwnPropertyNames(source).forEach(function(key){
		Object.defineProperty(object, key, Object.getOwnPropertyDescriptor(source, key));
	});
	return object;
};
*/

/*
var Class = function(prototype, declaration){
	if( declaration == null ){
		declaration = prototype;
		prototype = Class.prototype;
	}
	if( !declaration.constructor ) declaration.constructor = function(){};
	if( prototype instanceof Function ) prototype = prototype.prototype;

    declaration.constructor.prototype = Object.create(prototype, {
    	constructor: {
            configurable: true,
            enumerable: true,
            value: declaration.constructor,
            writable: true
        }
    });
    // add everything from the declaration onto the new prototype
    Object.append(declaration.constructor.prototype, declaration);

	return declaration.constructor;
};

var A = new Class({
	constructor: function(){
		//alert('new a called');
	},

	foo: 'bar',
	test: function(){ console.log('test called in a'); }
});

var B = new Class(A, {
	constructor: function(){
		//alert('new b called');
		//return this;
	},

	bar: 'foo',
	//test: function(){ console.log('test called in b'); }
});

var C = new Class(B, {
	constructor: function(){

	},

	//test: function(){ console.log('test called in c'); }
});

var a = new A();
var b = new B();
var c = new C();

console.log(
	'a', a instanceof A, a instanceof Class,
	'b', b instanceof A, b instanceof B,
	'c', c instanceof A, c instanceof B, c instanceof C
);

var Structure = {};
Object.defineProperty(Structure, 'test', {get: function(){ return 'ok'; }});

Object.merge(B.prototype, Structure);
Object.merge(A.prototype, Structure);

console.log(a.test);
*/

/*
var FileModel = new Class({
	Extends: NodeModel,
	Implements: Model.serverMethods,

	initialize: function(path){
		NodeModel.prototype.initialize.call(this, typeof path == 'string' ? {path: path} : path);
	},

	sync: function(action, callback){
		server.applyAction('filesystem/' + action.name, action.args, callback);
	},

	rename: function(name, callback){
		return this.send('rename', [this.get('path'), name], callback);
	}
});

NodeView.prototype.modelEvents.send = function(){
	// on n'affiche pas le loader tout de suite, uniquement si l'action dure
	this.timeout = setTimeout(function(){
		delete this.timeout;
		this.getDom('li').addClass('loading');
	}.bind(this), 300);
};

NodeView.prototype.modelEvents.complete = function(){
	if( this.timeout ){
		clearTimeout(this.timeout);
		delete this.timeout;
	}
	this.getDom('li').removeClass('loading');
};

var imgA = new FileModel('/img/aa');
imgA.rename('bb');

*/
</script>
