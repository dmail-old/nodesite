<!--

Ce fichier est renvoyé à toute requête GET sauf:

- si l'URL débute par un dossier existant: '/css/*, /js/*, /img/*'
- si l'URL cible la racine et un fichier d'extension différente de .js: '/manifest.appcache'

Il consititue le cadre du site, on récup des infos depuis le serveur dans les {}
Une fois tout ceci fait on appele app.init pour afficher la page correspondante

-->

<!DOCTYPE html>

<html dir="ltr">

	<head>
		{metas}
		<title>{title}</title>
		{favicon}
		{styles}

		<script type="text/javascript">
			// je vais surement juste écrire et laisser le serveur les mettre au lieu
			// d'appeler requirejs, en plus je mettrais directement des balises script remplies pour le serveur

			window.NS = {};
			window.config = {config};
			window.lang = JSON.stringify({lang});
			// Function.reviver existe pas encore ici
			lang = JSON.parse(lang, function(key, value){
				return typeof value == 'string' && value.indexOf('(function (') === 0 ? eval(value) : value;
			});

			window.root = config.protocol + '://' + config.host + (config.port ? ':' + config.port : '');

			window.onerror = function(msg, url, line){
				//console.log('window error', arguments);
			};

		</script>

	</head>

	<body>

		{scripts}

		<script>
			// app.init will be called once css and js have fully loaded
			window.onload = function(){
				// setTimeout is to avoid initial popstate event
				setTimeout(app.init, 0);
			};
		</script>

	</body>

</html>
